
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Postfix mail relays - Ting Wai's Blog</title>
  <meta name="author" content="Chong Ting Wai">

  
  <meta name="description" content="Recently I have to setup a mail server to notify me of system failure from Nagios. So, instead of setting the mail server from scratch, I decided to &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://ctingwai.github.com/blog/2013/10/09/postfix-mail-relays">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Ting Wai's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-41040867-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Ting Wai's Blog</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:ctingwai.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Postfix Mail Relays</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-10-09T14:31:00+08:00" pubdate data-updated="true">Oct 9<span>th</span>, 2013</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Recently I have to setup a mail server to notify me of system failure from Nagios. So, instead of setting the mail server from scratch, I decided to use my company&#8217;s email as a relay for notification.</p>

<!-- more -->


<p>Postfix are installed on most distros as the default MTA (Mail Transfer Agent). In cases where it is not installed, you can install by searching for postfix in your package manager, e.g. <code>sudo apt-cache search postfix</code>. Since, I am installing on a Ubuntu 12.04 machine, the instructions here lean more to Ubuntu systems, but it should work with other distros too. Configuration of mail server used to relay email from my Ubuntu machine: \</p>

<pre><code>Incoming server: smtp.domain.com (IMAP = Port 143, POP = Port 110)
Outgoing server: smtp.domain.com (SMTP = Port 587)
</code></pre>

<p>1. Add the following lines to <code>/etc/postfix/main.cnf</code>: \</p>

<pre><code># Settings for relay
relayhost = smtp.domain.com:587
smtp_sasl_auth_enable = yes
smtp_sasl_password_maps = hash:/etc/postfix/sasl/sasl_passwd
smtp_sasl_security_options = noanonymous, noplaintext
smtp_sasl_mechanism_filter = login, plain
smtp_generic_maps = hash:/etc/postfix/generic 
</code></pre>

<p>2. Add the following lines to /etc/postfix/sasl/sasl_passwd: \</p>

<pre><code>[smtp.domain.com]:587 username:password
</code></pre>

<p>3. Generating sasl_passwd.db file by running the following command: \</p>

<pre><code>$ sudo postfix /etc/sasl/sasl\_passwd
</code></pre>

<p>4. Make sure that only root can read both file:</p>

<pre><code>$ sudo chmod 600 /etc/sasl/sasl\_passwd*
</code></pre>

<p>5. Restart postfix:</p>

<pre><code>$ sudo /etc/init.d/postfix restart
</code></pre>

<p>6. Send a test mail:</p>

<pre><code>echo "Testing" | mail -s "Test" email@address.com
</code></pre>

<p>You should receive your email in the address you sent above. If you are not getting an email, check the system mail, email failed to sent will get sent back to your own machine along with some error messages, you can check the system mail by using <code>cat /var/mail/root</code>. Note however, not all mail servers allow mail relays.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Chong Ting Wai</span></span>

      








  


<time datetime="2013-10-09T14:31:00+08:00" pubdate data-updated="true">Oct 9<span>th</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/email/'>Email</a>, <a class='category' href='/blog/categories/linux/'>Linux</a>, <a class='category' href='/blog/categories/postfix/'>Postfix</a>, <a class='category' href='/blog/categories/ubuntu/'>Ubuntu</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/06/22/enable-internet-access-on-raspberry-pi-through-wired-connection/" title="Previous Post: Enable Internet Access on Raspberry Pi Through Wired Connection">&laquo; Enable Internet Access on Raspberry Pi Through Wired Connection</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/10/09/php-class-design-for-mysql/" title="Next Post: PHP Class Design for MySQL?">PHP Class Design for MySQL? &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    
<section class="googleplus">
	<h1>
		<a href=http://my.linkedin.com/pub/chong-ting-wai/23/999/b24/>
			<img src="http://developer.linkedin.com/sites/default/files/LinkedIn_Logo30px.png" />LinkedIn
		</a>
	</h1>
</section>


<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/110745063435175433790?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>


<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/10/09/php-class-design-for-mysql/">PHP Class Design for MySQL?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/10/09/postfix-mail-relays/">Postfix mail relays</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/22/enable-internet-access-on-raspberry-pi-through-wired-connection/">Enable Internet Access on Raspberry Pi Through Wired Connection</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/16/playing-multiple-tracks-vcd-on-linux/">Playing Multiple Tracks VCD on Linux</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/22/downloading-api-documentation-with-wget/">Downloading API Documentation with WGET</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/18/using-juniper-vpn-on-64-bit-linux/">Using Juniper VPN on 64 bit Linux</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/17/optimizing-linux-power-usage/">Optimizing Linux Power Usage</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/12/s2ram-as-default-suspending-method/">S2ram as default suspending method</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/29/fixing-incorrect-lid-state/">Fixing incorrect lid state</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/23/permanent-dns-settings-for-network-manager/">Permanent DNS Settings for Network Manager</a>
      </li>
    
  </ul>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Chong Ting Wai -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'ctingwai';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://ctingwai.github.com/blog/2013/10/09/postfix-mail-relays/';
        var disqus_url = 'http://ctingwai.github.com/blog/2013/10/09/postfix-mail-relays/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>







</body>
</html>
